"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{6231:(e,t,s)=>{s.d(t,{K:()=>y});var a=s(4807),l=s(2015),i=s(5547),r=s(3964),n=s(7812),c=s(9512),d=s(3844),o=s(176),m=s(1984);let x=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),g=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(d.b,{ref:t,className:(0,m.cn)(x(),s),...l})});g.displayName=d.b.displayName;var u=s(7332),h=s(9035),p=s(5475),f=s(2396),v=s(8514);let j=e=>{let{files:t,onFileSelect:s}=e,l=e=>{var t;return"file"===e.type?(0,a.jsxs)("div",{className:"flex items-center cursor-pointer hover:bg-zinc-700 p-1 rounded-md",onClick:()=>s(e.content||""),children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4 text-blue-400"}),(0,a.jsx)("span",{className:"text-zinc-300",children:e.name})]},e.name):(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4 text-yellow-400"}),(0,a.jsx)("span",{className:"text-zinc-200 font-semibold",children:e.name})]}),(0,a.jsx)("div",{className:"ml-4",children:null===(t=e.children)||void 0===t?void 0:t.map(l)})]},e.name)};return(0,a.jsx)("div",{className:"font-mono text-sm",children:t.map(l)})},b=e=>{let{code:t,minSpeed:s=50,maxSpeed:i=150}=e,[r,n]=(0,l.useState)(""),[c,d]=(0,l.useState)(0),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{n(""),d(0)},[t]),(0,l.useEffect)(()=>{if(c<t.length){let e=Math.min(Math.floor(Math.random()*(i/50-s/50+1))+s/50,t.length-c),a=setTimeout(()=>{n(s=>s+t.substring(c,c+e)),d(t=>t+e)},Math.random()*(1e3/s-1e3/i)+1e3/i);return()=>clearTimeout(a)}},[c,t,s,i]),(0,l.useEffect)(()=>{o.current&&(o.current.scrollTop=o.current.scrollHeight)},[r]),(0,a.jsxs)("pre",{ref:o,className:"whitespace-pre-wrap break-all text-sm text-zinc-300 bg-zinc-900 p-3 rounded-md overflow-auto h-full font-mono",children:[r,c<t.length&&(0,a.jsx)("span",{className:"animate-pulse",children:"|"})," "]})};var N=s(8640);function y(e){var t;let{isOpen:s,onClose:d,initialInput:o,tokenData:x}=e,[f,v]=(0,l.useState)(o),[y,w]=(0,l.useState)(!1),{toast:z}=(0,p.dj)(),[S,k]=(0,l.useState)(null),[C,E]=(0,l.useState)(null),[G,T]=(0,l.useState)([]),[A,F]=(0,l.useState)(!1),[I,O]=(0,l.useState)("input"),[R,M]=(0,l.useState)(""),{publicKey:$}=(0,N.v)(),U=(0,i.useRouter)();(0,l.useEffect)(()=>{s&&x&&L(x)},[s,x]);let L=async e=>{if(!e||!e.name&&!e.symbol){F(!1),T([]);return}F(!0);try{let t=await fetch("/api/suggest-game-ideas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tokenData:e})}),s=await t.json();s.suggestions&&T(s.suggestions)}catch(e){console.error("Error fetching suggested ideas:",e),z({title:"Error",description:"Failed to fetch suggested game ideas.",variant:"destructive"}),T([])}finally{F(!1)}},_=async()=>{w(!0),O("generating"),k(null),E(null);try{let e=await fetch("/api/generate-game",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:f,tokenDetails:x})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to generate game code.")}let t=await e.json();k(t.game),z({title:"Game Generated!",description:"Game code generated successfully!",variant:"default"}),O("visualizing")}catch(e){E(e.message),z({title:"Error",description:e.message,variant:"destructive"})}finally{w(!1)}},D=()=>{v(o),w(!1),k(null),E(null),O("input"),M(""),d()};return(0,l.useEffect)(()=>{if("visualizing"===I&&S&&S.files.length>0){let e=t=>{for(let s of t){if("file"===s.type&&s.content)return s.content;if("directory"===s.type&&s.children){let t=e(s.children);if(t)return t}}return""};M(e(S.files))}},[I,S]),(0,a.jsx)(r.lG,{open:s,onOpenChange:D,children:(0,a.jsxs)(r.Cf,{className:"sm:max-w-[800px] bg-zinc-900 text-white border-zinc-700",children:["input"===I&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.c7,{children:[(0,a.jsx)(r.L3,{className:"text-2xl font-pixel text-emerald-400",children:"Create Your Game"}),(0,a.jsx)(r.rr,{className:"text-zinc-400",children:"Enter your game idea or confirm the token details to generate your game."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[x&&(0,a.jsxs)("div",{className:"grid grid-cols-4 items-start gap-4",children:[(0,a.jsx)(g,{className:"text-right text-zinc-300 pt-2",children:"Token Info"}),(0,a.jsxs)("div",{className:"col-span-3 flex items-center gap-4 bg-zinc-800 border border-zinc-700 rounded-md p-3",children:[x.logoURI&&(0,a.jsx)("img",{src:x.logoURI,alt:"".concat(x.name," logo"),className:"w-12 h-12 rounded-full object-cover border border-zinc-600"}),(0,a.jsxs)("div",{className:"flex-1 text-sm text-zinc-300",children:[(0,a.jsxs)("p",{className:"text-base font-semibold text-emerald-300",children:[x.name," (",x.symbol,")"]}),(0,a.jsxs)("p",{className:"text-zinc-400 text-xs truncate",children:["Address: ",(0,m.M)(x.address)]}),(0,a.jsx)("div",{className:"flex justify-between mt-1",children:(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Mkt Cap:"})," $",(null===(t=x.marketCap)||void 0===t?void 0:t.toLocaleString())||"N/A"]})})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(g,{htmlFor:"gameIdea",className:"text-right text-zinc-300",children:"Game Idea"}),(0,a.jsx)(c.p,{id:"gameIdea",value:f,onChange:e=>v(e.target.value),className:"col-span-3 bg-zinc-800 border-zinc-700 text-white",disabled:y||A,placeholder:A?"Fetching suggestions...":"Enter your game idea..."})]}),G.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-4 items-start gap-4",children:[(0,a.jsx)(g,{className:"text-right text-zinc-300 pt-2",children:"Suggestions"}),(0,a.jsx)("div",{className:"col-span-3 flex flex-wrap gap-2",children:G.map((e,t)=>(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>v(e),className:"bg-zinc-700 hover:bg-zinc-600 text-zinc-200 border-zinc-600 text-sm px-3 py-1",children:e},t))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.$,{variant:"outline",onClick:D,disabled:y,className:"border-zinc-700 text-zinc-300 hover:bg-zinc-800",children:"Cancel"}),(0,a.jsx)(n.$,{onClick:_,disabled:y||!f,className:"bg-emerald-500 hover:bg-emerald-600 text-white font-pixel",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"})," Generating..."]}):"Generate Game"})]})]}),"generating"===I&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64",children:[(0,a.jsx)(u.A,{className:"h-12 w-12 animate-spin text-emerald-400"}),(0,a.jsx)("p",{className:"mt-4 text-lg font-pixel",children:"Generating your game..."}),(0,a.jsx)("p",{className:"text-zinc-400 text-sm",children:"This might take a moment."})]}),"visualizing"===I&&S&&(0,a.jsxs)("div",{className:"flex flex-col h-[500px]",children:[" ",(0,a.jsxs)(r.c7,{children:[(0,a.jsx)(r.L3,{className:"text-2xl font-pixel text-emerald-400",children:"Game Generated!"}),(0,a.jsxs)(r.rr,{className:"text-zinc-400",children:[S.gameTitle," - ",S.gameDescription]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden mt-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 h-full",children:[(0,a.jsxs)("div",{className:"col-span-1 bg-zinc-800 p-4 rounded-lg overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-lg font-pixel text-emerald-300 mb-2",children:"File Tree"}),(0,a.jsx)(j,{files:S.files,onFileSelect:M})]}),(0,a.jsxs)("div",{className:"col-span-2 bg-zinc-800 p-4 rounded-lg overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-lg font-pixel text-emerald-300 mb-2",children:"Code"}),R?(0,a.jsx)(b,{code:R,minSpeed:50,maxSpeed:150}):(0,a.jsx)("p",{className:"text-zinc-400",children:"Select a file to view its content."})]})]})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)(n.$,{variant:"outline",onClick:D,className:"border-zinc-700 text-zinc-300 hover:bg-zinc-800",children:"Close"}),(0,a.jsx)(n.$,{className:"bg-emerald-500 hover:bg-emerald-600 text-white font-pixel",onClick:async()=>{if(S)try{var e;let t=await fetch("/api/games",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...S,gameType:"ai-generated",files:S.files,tokenSymbol:(null==x?void 0:x.symbol)||"UNKNOWN",tokenAddress:null==x?void 0:x.address,imageUrl:(null==x?void 0:x.logoURI)||"/placeholder-logo.svg",author:(null==$?void 0:$.toBase58())||"anonymous",tags:["generated","ai-generated"],marketCap:(null==x?void 0:null===(e=x.marketCap)||void 0===e?void 0:e.toLocaleString())||"N/A",plays:0,forks:0,timestamp:new Date().toISOString(),category:"community"})}),s=await t.json();t.ok?(z({title:"Game Saved!",description:"Your game has been successfully saved.",variant:"default"}),U.push("/play/".concat(s.gameId))):z({title:"Error",description:"Failed to save game: ".concat(s.error),variant:"destructive"})}catch(e){console.error("Error saving game:",e),z({title:"Error",description:"An error occurred while saving the game.",variant:"destructive"})}},children:"Save Game"})]})]}),C&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-red-900/20 rounded-md border border-red-700 text-red-400 flex items-center",children:[(0,a.jsx)(h.A,{className:"mr-2 h-5 w-5"}),(0,a.jsx)("p",{children:C})]})]})})}},9512:(e,t,s)=>{s.d(t,{p:()=>r});var a=s(4807),l=s(2015),i=s(1984);let r=l.forwardRef((e,t)=>{let{className:s,type:l,...r}=e;return(0,a.jsx)("input",{type:l,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});r.displayName="Input"}}]);